1) Программа не компилируется, если вызвать макрос CALLM более одного раза.
2) RET n работает так, что сначала он осуществляет возврат, снимая адрес возврата со стека, и только потом снимает со стека ещё n байт; у Вас происходит наоборот.
3) Это скорее небольшое замечание, поскольку макрос работает корректно, но в LOOPM необязательно сохранять значение CX, поскольку сама инструкция LOOP ассемблера его точно так же не сохраняет.